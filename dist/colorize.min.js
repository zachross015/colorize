(function(a){a.fn.colorize=function(b){return this.each(function(){var c=a(this);var d=a(this).data("colorize");if(d!==undefined){clearTimeout(d.iterate);c.removeData("colorize")}c.data("colorize",new a.colorize(c,b))})};a.colorize=function(c,b){this.o={color:"white",textDecoration:"none",direction:"forwards",speed:15,callback:function(){}};this.el=c;this.opt=a.extend({},this.o,b);this.se=[];this.lsc=false;this.rsc=false;this.lst="";this.rst="";this.lsi=0;this.rsi=0;this._init()};a.colorize.prototype={_init:function(){this._wrapText(this.el);this._parseElement();this._determineStart();this._expand()},_determineStart:function(){if(this.opt.direction=="backwards"){this.lsi=this.se.length-1;this.rsi=this.se.length}else{this.lsi=-1;this.rsi=0}},_expand:function(){if(this.rsi>=this.se.length-1){this.rsc=true}else{this._expandRight()}if(this.lsi<1){this.lsc=true}else{this._expandLeft()}this.el.html(this._finalHTML());var b=this;var c=this.el;this.iterate=setTimeout(function(){if(!(b.rsc&&b.lsc)){b._expand()}else{a(".colored").filter(function(){return a(this).text().length==0}).remove();b.opt.callback.call(c)}},this.opt.speed)},_expandRight:function(){var b=false;if(a(this.se[this.rsi].txt).prop("className")=="colored"){this._swap(this.rsi,this.rsi+1);b=true;if(this.se[this.rsi].txt=="</span>"){this.se.splice(this.rsi,2)}}if(this.rsi==this.se.length){return}if(this.se[this.rsi].type=="tag"&&!b){this.rst+="</span>";while(this.se[this.rsi+1].type=="tag"){this.rst+=this.se[this.rsi].txt;this.rsi++;if(this.rsi+1==this.se.length-1){return}}this.rsi--;this.rst+=this._tagHTML()}else{this.rst+=this.se[this.rsi].txt}this.rsi++},_expandLeft:function(){var d=false;var c=false;if(this.se[this.lsi].txt=="</span>"){this._swap(this.lsi,this.lsi-1);d=true;if(this.se[this.lsi].type=="tag"){if(a(this.se[this.lsi].txt).prop("className")=="colored"){this.se.splice(this.lsi-1,2);this.lsi-=1;this.rsi-=2;c=true}}}if(this.se[this.lsi].type=="tag"&&!d){var b=this._tagHTML();while(this.se[this.lsi-1].type=="tag"){b=this.se[this.lsi].txt+b;this.lsi--;if(this.lsi==0){return}}this.lsi++;this.lst="</span>"+b+this.lst}else{if(!c){this.lst=this.se[this.lsi].txt+this.lst}}this.lsi--},_swap:function(b,d){var c=this.se[b];this.se[b]=this.se[d];this.se[d]=c},_isVisible:function(){return true},_tagHTML:function(){var b="display:inline;pointer-events:none;";b+="color:"+this.opt.color+";";b+="text-decoration:"+this.opt.textDecoration+";";return"<span class = 'colored' style = '"+b+"'>"},_getHTML:function(e,d){var c="";for(var b=e;b<d;b++){c+=this.se[b].txt}return c},_finalHTML:function(){var b=this._getHTML(0,this.lsi+1);var c=this._getHTML(this.rsi,this.se.length);return b+this._tagHTML()+this.lst+"</span>"+this._tagHTML()+this.rst+"</span>"+c},_wrapText:function(c){var b=this;a(c).children().each(function(){b._wrapText(a(this))});c.contents().filter(function(){return this.nodeType===3&&this.parentElement.className!="colored"&&a(this).text().replace(/\s/g,"").length>0}).wrap("<span class = 'colored'></span>")},_parseElement:function(){var c=this.el.html();var d="";for(var b=0;b<c.length;b++){d+=c.charAt(b);if(d.charAt(0)=="<"){if(/<[^>]*>/.test(d)){this.se.push({txt:d,type:"tag"});d=""}}else{if(d.charAt(0)=="&"){if(/&[^;]*;/.test(d)){this.se.push({txt:d,type:"entity"});d=""}}else{this.se.push({txt:d,type:"text"});d=""}}}}}}(jQuery));
